<!DOCTYPE html>
<html>
<head>
    <title>Web Dev Chat Rooms</title>
    <!-- Add any head elements like CSS files -->
</head>
<body>
    <h1>Welcome to Web Development Chat</h1>

    <!-- Room Selection -->
    <!-- Ensure Materialize classes are used -->
    <div class="input-field">
        <select id="roomSelect">
            <option value="" disabled selected>Choose your room</option>
            <option value="htmlCSS">HTML & CSS</option>
            <option value="javascript">JavaScript</option>
            <option value="node">Node.js & Express</option>
            <option value="mongo">MongoDB</option>
            <option value="react">React</option>
            <!-- ... other options ... -->
        </select>
        <label>Room Selection</label>
    </div>
    <button onclick="joinRoom()">Join Room</button>

    <!-- Chat Messages and Input -->
    <div id="chatBox">
        <!-- Messages will be displayed here -->
    </div>
    <input type="text" id="messageInput" placeholder="Type a message...">
    <button onclick="sendMessage()">Send</button>

    <!-- Socket.IO Client -->
    <script src="/socket.io/socket.io.js"></script>
<script>
    console.log(io); // Should log the io function if loaded correctly
    var socket = io();
    socket.on('connect', () => {
    console.log('Connected to the server');
    });

    var currentRoom = '';
    var name = 'User';  

    function joinRoom() {
        currentRoom = document.getElementById('roomSelect').value;
        if (currentRoom && name) {
            socket.emit('join', { room: currentRoom, name: name });
            console.log(`Attempting to join room: ${currentRoom} as ${name}`);
        } else {
            console.error('Room or name is undefined');
        }
    }

    function sendMessage() {
    var messageInput = document.getElementById('messageInput');
    var message = messageInput.value;
    socket.emit('message', { room: currentRoom, name: name, message: message });

    messageInput.value = '';
}

    socket.on('message', function(data) {
    var chatBox = document.getElementById('chatBox');

    // Check if the message is from the current user or others
    var senderName = data.name === name ? 'Me' : data.name;
    chatBox.innerHTML += '<p><strong>' + senderName + ':</strong> ' + data.message + '</p>';
});
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var elems = document.querySelectorAll('select');
            var instances = M.FormSelect.init(elems);
        });
    </script>
</body>
</html>